z:=-145;
p:=(z+1)^2*(z^38-z^19+1)div 3-z^39;
t:=-z^20+z+1;
r:=Evaluate(CyclotomicPolynomial(114),z);
Fp:=GF(p);
F19<u>:=ExtensionField<Fp,u|u^19+u+31>;
E:=EllipticCurve([F19|0,31]);
f:=31*7057*1024166481266011*25458672421299369338221;
cof:=6992507321346145947013434963533601228664752664812337223658418266626784911893031\
9539795939419446427865758918080203103910770812644005018854623241567729464670572\
4007843523963840778760158215997673644202219014375950064716907323284704882905166\
0343750615329926907298287718476931763080039808622730601762247250382603978834793\
5781878703741504228036121270591676482744819734600140295192696826408051945186813\
5487733558980387776585395708752323551758405286523927918412744210317129316363334\
4713621020784977394989986192508536081037879648203757302178306446312908810423845\
7641872434113874305535265888811464186519102890929931506433860010975367724334855\
8975152225278999667680868902459411438755975448378358526696603996385348014307106\
6822317609515516686438327693943304194001251793628895125526679837827006558143050\
2061327486998025533951344844213018685688543517967420561801058835392244065911770\
5043646049400880819899505010970845842201606117404088751967882316812839183554772\
1601032979085208942990961269304138799527111623855545305108200883940991444029876\
4258169304818324757163787429462676825036404510296576213649462927547644434163812\
5020484985096551176886370921212587485252154636150260084584111239218661727252427\
8363344463814984256556028221155502307374032249755189810021426776373630058151676\
3995974817810611589117015297568092025359758126311140860287854205409078640039341\
0879972423855676004411370909940659471328247853603002576319591662011372343658942\
644723764932823130754362275699896337920284699233;
//w:=Random(Fp)^((p-1) div 3);
w:=1364614900770326371786571581106544735789185132426333114702258894978661275889775\
5244;
//XGCD(2*f, r*cof);
f2_inv:=-3652083546196781227940474036312569634973825756708134529201970717288410156318\
9380190995714077167258683747056443695987440805412299707401908484382366264350306\
0215490947497176437235967940309875277117793196330843904235312177974664845936711\
1090582242973784577367075149034518873974213740105006483861031751804438863559120\
3979803025009931607639796583187137493090713591964598889779420083050163937894341\
6986155517700769223286072556127835648511613277383065612961428353966923233221509\
5349161924790081428397604259405910525806403022715169561652842904813902677936875\
0828825089232657185420744641121007476949936505531866383660072128491360470804797\
7033635692575561214748893676714545838479675362312149670907339926168130926653337\
5549717283856790078275493941848669923166007967776289339993499223242354386646860\
4100542912643350238984801689417057376875454580940436012277155480585519298964923\
7847623768858177402993571297320019859170430084006811417280810134657358769183912\
9316766160098135552722888101337438505158755416051074196323383281509667737785404\
4917253621481161821384512676686390276297932196824767150867523911311337512706944\
5777549135920606492807634528997776975357787011049466841481586804977441340260152\
2085602366704372909601143002376378301808793233022714800616049364132896535454907\
9911711953491233884492207499021697126992901739601813601981705144719689644512587\
6153308931050128750228203950190913411835799340434825021755581002391464873573103\
5992204207731579607826845510612947446117614227466258076987050922022959019225740\
4774469672394824011424291882836653023570294141165;
/*Computing the parameter b such that  \pi(P)=[a]P for all P\in G*/
P<x>:=PolynomialRing(Integers());
g:=x^2-t*x+p; 
q:=P!CyclotomicPolynomial(19);
R:=quo<P|g>;
h:=R!q;
H:=Coefficients(h);
a:=Solution(H[2],-H[1],r*cof);
a:=1129649072009289361420006149216927435434500703632719467351810708514597080147489\
9054406187293622020588589217698102163006076800898341931028875746241253975281750\
2644798542799571239206904694777506407987010532914949778984789240387159004405350\
4629289931802172419039855391969949470078063664952468309319374388341559247609052\
8696665909871874617966611206785278981567096272182579615527962033126805692593160\
8611894370544706931500017565392320714852571791424222338348029769516693992030879\
3702963371816069538121844679664768147726644276472196384868980344495793154498585\
4665939617289003763216847219620754429486276236500558173357279134317407316149935\
7801853785410992983668044494731532767237479184762644348514121941995371194726258\
7112061949349277894418720165928387297460535052149271725010185365559900984535101\
6163071708319023915542885026480042447824307770380867246257912528291874145215061\
3224050360216293966096622691424839748069918921959591309207236400641042095144955\
7236798360277707523016882304106921283930898288865954350641609535620029850465717\
9996947612903254815173092877919558286380408473194429387282175533223302144094728\
0819702058132982570392402641398801998544062644568567044238776973134128939730349\
2536636706351314374705160133777993715172657615245770025739416164792084743963176\
3207967814028217183823425049873889408144499399560516897451847919414328322039877\
0217634170337181048906586019207958688594804771879155096367550594380236262003223\
1238989138409465893804219455164928504293431674071399400305601895140580967341615\
38432146901629533654627703850826100190984627103;
/*computing b such that (w*x,y)=b(x,y) for (x,y)\in G*/
b:=((-f+2*a-t)*f2_inv) mod (cof*r);
Q:=Random(E);
R:=E![Q[1]^p, Q[2]^p, 1]-Q;

/*computing  s such that (w*x^p,y^p)=s(x,y) for (x,y)\in G*/
s:=a*b mod (cof*r);

/*computing h_i */
B:=RMatrixSpace(Integers(),35,35)!0;
B[1][1]:=cof;
for i:=2 to 35 do
 B[i][1]:=-s^(i-1) mod (r*cof);B[i][i]:=1;
end for;
L := LatticeWithBasis(B);
h:=ShortestVector(L);
/*Checking h is correct*/ 
Q:=Random(E);P:=E![Q[1]^p,Q[2]^p,1]-Q;
R:=E![0,1,0];
for i:=1 to 35 do
    R:=R+h[i]*E![w^(i-1)*P[1]^(p^(i-1)),P[2]^(p^(i-1)),1];
end for;
if R[3] ne 0 then 

	if E![R[1]^p,R[2]^p,1] eq p*R  and r*R eq E![0,1,0] then 
		printf"this method is CORRECT!\n";
	else
		printf"this method is ERROR!\n";
	end if;

else
	printf"the random point is  trival\n";
end if;
h;
